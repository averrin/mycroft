{%extends "index.html"%}
{%block content%}
    <script src="/mycroft/static/js/table.js"></script>
<div id="projects" class="col-sm-8">
  <h2>Mycroft projects:
    <a class="btn btn-default" href="/mycroft/dashboard">dashboard</a>
    <button class="btn btn-default pull-right" id="add"><i class="glyphicon glyphicon-plus" style="top: 0"></i></button>
  </h2>
<table class="table table-bordered table-stripped" id="projects-table">
  <thead>
    <tr>
      <th>Project</th>
      <th>Status</th>
      <th>Details</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for project in projects %}
    <tr id="{{project.name}}">
      <td>
        <a href="/mycroft/view/{{project.name}}">
        {{project.full_name}}</a>
      </td>
      <td>
        {% if project.builds %}
          <a href='{{project.builds[0].report}}'>{{project.builds[0].name}}</a>
          {%if project.artefact%}
          <br><a href="{{project.artefact}}">Artefact</a>{%endif%}{%if project.ftp_artefact%}&nbsp;<strong>&amp;</strong>&nbsp;<a href="{{project.ftp_artefact}}">FTP Artefactory</a>
          {%endif%}
        {%endif%}
      </td>
      <td id='{{project.name}}-details'>
        <div class="git-info">
          <ul></ul>
        </div>
      </td>
      <td>
        <button class="run btn btn-primary" data-project="{{project.name}}">run</button>
        <div class="dropdown" style="display: inline-block">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                Actions
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="Actions">
                {%if project.web_url%}
                  <li role="presentation"><a href='project.web_url' class="deployed"><i class="glyphicon glyphicon-globe" style="top: 0; margin-right: 20px;"></i> View deployed</a></li>
                  {%endif%}
                {% if project.release_action %}
                <li role="presentation"><a href='#' data-project="{{project.name}}" class="release"><i class="glyphicon glyphicon-thumbs-up" style="top: 0; margin-right: 20px;"></i> Deploy as release</a></li>
                {% endif %}
                <li role="presentation"><a href='edit/{{project.name}}' data-project="{{project.name}}" class="edit"><i class="glyphicon glyphicon-pencil" style="top: 0; margin-right: 20px;"></i> Edit</a></li>
                <li role="presentation"><a href='#' data-project="{{project.name}}" class="delete"><i class="glyphicon glyphicon-remove" style="top: 0; margin-right: 20px;"></i> Delete</a></li>

            </ul>
        </div>
      </td>
    </tr>
    {%endfor%}
  </tbody>
</table>
</div>
{%endblock%}
